import{_ as a,c as e,o as s,a2 as n}from"./chunks/framework.U6HXpukZ.js";const l="/assets/image-oezt.Aa-VE_3h.png",r="/assets/image-sfal.D4YKuRZr.png",g=JSON.parse('{"title":"使用kube-vip实现LoadBalancer（Layer2模式）","description":"","frontmatter":{},"headers":[],"relativePath":"lb-kubevip-loadbalancer.md","filePath":"lb-kubevip-loadbalancer.md"}'),t={name:"lb-kubevip-loadbalancer.md"},i=n(`<h1 id="使用kube-vip实现loadbalancer-layer2模式" tabindex="-1">使用kube-vip实现LoadBalancer（Layer2模式） <a class="header-anchor" href="#使用kube-vip实现loadbalancer-layer2模式" aria-label="Permalink to &quot;使用kube-vip实现LoadBalancer（Layer2模式）&quot;">​</a></h1><h3 id="前提条件" tabindex="-1">前提条件 <a class="header-anchor" href="#前提条件" aria-label="Permalink to &quot;前提条件&quot;">​</a></h3><ul><li>kube-vip</li></ul><h3 id="安装云控制管理器" tabindex="-1">安装云控制管理器 <a class="header-anchor" href="#安装云控制管理器" aria-label="Permalink to &quot;安装云控制管理器&quot;">​</a></h3><p>官方文档：<a href="https://kube-vip.io/docs/usage/cloud-provider/#using-the-kube-vip-cloud-provider" target="_blank" rel="noreferrer">On-Premises (kube-vip-cloud-controller) | kube-vip</a></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>wget https://github.com/kube-vip/kube-vip-cloud-provider/blob/v0.0.10/manifest/kube-vip-cloud-controller.yaml</span></span>
<span class="line"><span>kubectl apply -f kube-vip-cloud-controller.yaml</span></span></code></pre></div><h3 id="创建cidr" tabindex="-1">创建CIDR <a class="header-anchor" href="#创建cidr" aria-label="Permalink to &quot;创建CIDR&quot;">​</a></h3><h4 id="快速配置-创建全局lb网段" tabindex="-1">快速配置，创建全局LB网段 <a class="header-anchor" href="#快速配置-创建全局lb网段" aria-label="Permalink to &quot;快速配置，创建全局LB网段&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>kubectl create configmap -n kube-system kubevip --from-literal range-global=172.25.2.51-172.25.2.100</span></span></code></pre></div><h4 id="高级配置" tabindex="-1">高级配置 <a class="header-anchor" href="#高级配置" aria-label="Permalink to &quot;高级配置&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>apiVersion: v1</span></span>
<span class="line"><span>kind: ConfigMap</span></span>
<span class="line"><span>metadata:</span></span>
<span class="line"><span>  name: kubevip</span></span>
<span class="line"><span>  namespace: kube-system</span></span>
<span class="line"><span>data:</span></span>
<span class="line"><span>  cidr-default: 192.168.0.200/29                      # default命名空间CIDR</span></span>
<span class="line"><span>  range-development: 192.168.0.210-192.168.0.219      # development命名空间IP池</span></span>
<span class="line"><span>  cidr-finance: 192.168.0.220/29,192.168.0.230/29     # finance命名空间CIDR</span></span>
<span class="line"><span>  cidr-global: 192.168.0.240/29                       # 全局CIDR</span></span></code></pre></div><blockquote><p>如果service不使用kube-vip提供的LB，在<code>servicemetadata.annotations</code>处配置<code>kube-vip.io/ignore=true</code> 告诉kube-vip 忽略掉这个服务</p></blockquote><h3 id="设置service为loadbalancer" tabindex="-1">设置service为LoadBalancer <a class="header-anchor" href="#设置service为loadbalancer" aria-label="Permalink to &quot;设置service为LoadBalancer&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>kubectl edit svc -n namespace svc</span></span></code></pre></div><p><img src="`+l+'" alt="img"></p><p><img src="'+r+'" alt="img"></p><h3 id="配合metallb使用kube-vip" tabindex="-1">配合MetalLB使用kube-vip <a class="header-anchor" href="#配合metallb使用kube-vip" aria-label="Permalink to &quot;配合MetalLB使用kube-vip&quot;">​</a></h3><p>原文地址：<a href="https://sreok.cn/archives/81eb2a31-1b61-4331-bf40-098cbd20624c" target="_blank" rel="noreferrer">【故障排查】kube-vip 与 MetalLB LoadBalancer Layer2 ARP冲突 - Elijah Blog (</a><a href="http://sreok.cn" target="_blank" rel="noreferrer">sreok.cn</a><a href="https://sreok.cn/archives/81eb2a31-1b61-4331-bf40-098cbd20624c" target="_blank" rel="noreferrer">)</a></p><p>原文地址：<a href="https://sreok.cn/archives/f0b5ce93-4404-4ed3-a3b8-a0745ff8cc23" target="_blank" rel="noreferrer">使用MetalLB为k8s集群提供负载均衡服务（Layer 2模式） - Elijah Blog (</a><a href="http://sreok.cn" target="_blank" rel="noreferrer">sreok.cn</a><a href="https://sreok.cn/archives/f0b5ce93-4404-4ed3-a3b8-a0745ff8cc23" target="_blank" rel="noreferrer">)</a></p>',19),p=[i];function o(c,d,b,h,u,k){return s(),e("div",null,p)}const m=a(t,[["render",o]]);export{g as __pageData,m as default};
